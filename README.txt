This code is from teaching.
 